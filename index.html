<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyber Relics: System</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-body: #050508;
            --bg-card: #13131f;
            --bg-glass: rgba(19, 19, 31, 0.95);
            --primary: #00f3ff;
            --secondary: #bc13fe;
            --accent: #ff003c; /* Red for Admin */
            --text-main: #ffffff;
            --text-muted: #7d8ca3;
            --gold: #ffaa00;
            --nav-height: 75px;
            --header-height: 60px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            height: 100vh;
            background-image: radial-gradient(circle at 50% 0%, rgba(0, 243, 255, 0.05) 0%, transparent 50%);
        }

        .cyber-font { font-family: 'Orbitron', sans-serif; }
        .hidden { display: none !important; }
        .btn { border: none; outline: none; cursor: pointer; transition: 0.2s; }
        
        /* --- LAYOUT --- */
        #app { display: flex; flex-direction: column; height: 100%; }

        /* --- HEADER --- */
        header {
            height: var(--header-height);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 16px; background: var(--bg-glass);
            border-bottom: 1px solid rgba(255,255,255,0.05); z-index: 100;
        }
        .app-logo { font-size: 18px; font-weight: 900; letter-spacing: 1px; }
        .header-balance {
            background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1);
            padding: 5px 12px; border-radius: 20px; font-size: 13px;
            display: flex; align-items: center; gap: 5px; cursor: pointer;
        }

        /* --- CONTENT --- */
        .content-view {
            flex: 1; overflow-y: auto; padding-bottom: calc(var(--nav-height) + 20px);
            opacity: 0; animation: fadeIn 0.3s forwards; display: none;
        }
        .content-view.active { display: block; }
        @keyframes fadeIn { to { opacity: 1; } }

        /* --- ADMIN PANEL STYLES --- */
        .admin-panel-card {
            background: #1a0505; border: 1px solid var(--accent);
            border-radius: 12px; padding: 15px; margin: 16px;
            box-shadow: 0 0 15px rgba(255, 0, 60, 0.2);
        }
        .admin-stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .admin-stat { background: rgba(255,0,60,0.1); padding: 10px; border-radius: 8px; text-align: center; }
        .admin-input {
            width: 100%; background: #000; border: 1px solid #333; color: var(--primary);
            padding: 10px; border-radius: 6px; margin-bottom: 10px; font-family: 'Courier New', monospace;
        }
        .btn-admin {
            width: 100%; padding: 10px; background: var(--accent); color: white;
            font-weight: bold; border-radius: 6px; text-transform: uppercase;
        }
        .user-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px; border-bottom: 1px solid #333; font-size: 12px;
        }

        /* --- OTHER STYLES (From previous req) --- */
        .hero-banner {
            position: relative; height: 300px;
            background: url('https://img.freepik.com/free-photo/futuristic-city-with-neon-lights_23-2149089862.jpg') center/cover;
            display: flex; align-items: center; justify-content: center; text-align: center;
        }
        .cases-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 16px; }
        .case-card {
            background: var(--bg-card); border-radius: 16px; padding: 12px;
            text-align: center; border: 1px solid rgba(255,255,255,0.05); position: relative;
        }
        .btn-main {
            background: linear-gradient(90deg, #0066ff, var(--primary));
            padding: 12px; width: 100%; border-radius: 10px; font-weight: 700; color: #000;
        }

        /* --- NAV --- */
        .bottom-nav {
            height: var(--nav-height); background: #0a0a10;
            border-top: 1px solid rgba(255,255,255,0.05);
            display: flex; justify-content: space-around; align-items: center;
            position: fixed; bottom: 0; width: 100%; z-index: 100;
            padding-bottom: 10px;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--text-muted); font-size: 10px; width: 20%; opacity: 0.6; }
        .nav-item.active { color: var(--primary); opacity: 1; }
        .nav-item.active i { transform: translateY(-3px); text-shadow: 0 0 10px var(--primary); }
        
        .nav-item.center-btn .icon-wrap {
            width: 45px; height: 45px; background: linear-gradient(135deg, var(--secondary), var(--primary));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.4); margin-bottom: -15px; border: 4px solid var(--bg-body);
        }
        .nav-item.center-btn i { color: #000; font-size: 20px; }
        
        /* Admin Button in Nav (Hidden by default) */
        #nav-admin { display: none; }
        #nav-admin.visible { display: flex; color: var(--accent); }
        #nav-admin.active { color: var(--accent); text-shadow: 0 0 10px var(--accent); }

    </style>
</head>
<body>

<div id="app">
    <header>
        <div class="header-left" style="display:flex; align-items:center; gap:10px;">
            <i class="fa-solid fa-bars" onclick="tg.showAlert('Menu is under construction')"></i>
            <div class="app-logo"><span style="color:var(--secondary)">Cyber</span>Relics</div>
        </div>
        <div class="header-right" style="display:flex; align-items:center; gap:10px;">
            <div class="header-balance" onclick="switchTab('profile')">
                <i class="fa-solid fa-microchip" style="color: var(--gold);"></i> 
                <span id="header-balance-val">0</span>
            </div>
            <img id="user-avatar" src="" style="width:32px; height:32px; border-radius:50%; border:1px solid var(--primary);" onclick="switchTab('profile')">
        </div>
    </header>

    <div id="main-container">
        
        <div id="view-cases" class="content-view active">
            <div class="hero-banner">
                <div style="position:absolute; inset:0; background:rgba(0,0,0,0.5);"></div>
                <div style="position:relative; z-index:2; width:100%; padding:20px;">
                    <div style="font-family:'Orbitron'; font-size:32px; line-height:1; margin-bottom:10px; text-shadow:0 0 10px var(--primary);">SEASON<br>BREACH</div>
                    <button class="btn btn-main" style="width:60%;" onclick="openModal('season')">Open Pass</button>
                </div>
            </div>
            
            <div style="padding:16px;">
                <div style="font-size:12px; color:var(--text-muted); margin-bottom:10px;">AVAILABLE ARCHIVES</div>
                <div class="cases-grid">
                    <div class="case-card" onclick="tryBuyCase(250)">
                        <img src="https://cdn-icons-png.flaticon.com/512/3062/3062634.png" style="width:70px; filter:hue-rotate(180deg);">
                        <div class="cyber-font" style="font-size:12px; margin:5px 0;">Neon Ghost</div>
                        <div style="font-weight:700; font-size:12px;">üí† 250</div>
                    </div>
                    <div class="case-card" onclick="tryBuyCase(500)">
                        <img src="https://cdn-icons-png.flaticon.com/512/9626/9626643.png" style="width:70px;">
                        <div class="cyber-font" style="font-size:12px; margin:5px 0;">Cyber Core</div>
                        <div style="font-weight:700; font-size:12px;">üí† 500</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-upgrade" class="content-view">
            <div style="padding:20px; text-align:center;">
                <h2 class="cyber-font">UPGRADE STATION</h2>
                <div style="width:200px; height:200px; border-radius:50%; border:2px dashed var(--secondary); margin:40px auto; display:flex; align-items:center; justify-content:center;">
                    <i class="fa-solid fa-bolt" style="font-size:50px; color:#333;"></i>
                </div>
                <button class="btn btn-main" onclick="tg.showAlert('Select an item from inventory first')">Select Item</button>
            </div>
        </div>

        <div id="view-crafts" class="content-view">
            <div style="padding:16px;">
                <h2 class="cyber-font" style="text-align:center; margin-bottom:20px;">SYNTHESIS</h2>
                <div style="display:grid; grid-template-columns:repeat(5,1fr); gap:8px;">
                    <script>
                        for(let i=1; i<=10; i++) document.write(`<div style="aspect-ratio:1; background:#111; border:1px solid #333; border-radius:6px; display:flex; align-items:center; justify-content:center; color:#444;">${i}</div>`);
                    </script>
                </div>
            </div>
        </div>

        <div id="view-profile" class="content-view">
            <div style="text-align:center; padding:30px 0; background:linear-gradient(to bottom, rgba(0,243,255,0.1), transparent);">
                <img id="profile-avatar-xl" src="" style="width:80px; height:80px; border-radius:50%; border:3px solid var(--primary); box-shadow:0 0 15px var(--primary);">
                <h2 id="profile-name" style="margin-top:10px;">User</h2>
                <div id="profile-id" style="font-size:11px; color:var(--text-muted);">ID: Loading...</div>
            </div>
            
            <div style="background:var(--bg-card); margin:16px; padding:15px; border-radius:12px; display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size:11px; color:var(--text-muted);">Balance</div>
                    <div style="font-size:20px; font-weight:700; color:var(--primary);">üí† <span id="profile-balance">0</span></div>
                </div>
                <button class="btn" style="background:rgba(255,255,255,0.1); padding:8px 15px; border-radius:6px; color:white;">Top Up</button>
            </div>
        </div>

        <div id="view-admin" class="content-view">
            <div style="padding:16px;">
                <h2 class="cyber-font" style="color:var(--accent); text-align:center; margin-bottom:10px;">SYSTEM ROOT ACCESS</h2>
                <div style="text-align:center; font-size:10px; color:#555; margin-bottom:20px;">TERMINAL v.2.0.4 | ID: 1017573139</div>

                <div class="admin-stat-grid">
                    <div class="admin-stat">
                        <div style="font-size:20px; font-weight:bold;">12,405</div>
                        <div style="font-size:10px;">TOTAL USERS</div>
                    </div>
                    <div class="admin-stat">
                        <div style="font-size:20px; font-weight:bold;">$45k</div>
                        <div style="font-size:10px;">REVENUE</div>
                    </div>
                </div>

                <div class="admin-panel-card">
                    <h3 style="margin-bottom:10px; font-size:14px;">God Mode: Balance</h3>
                    <input type="number" id="admin-amount" class="admin-input" placeholder="Amount (e.g. 1000)">
                    <div style="display:flex; gap:10px;">
                        <button class="btn-admin" onclick="adminAction('add_balance')">Add üí†</button>
                        <button class="btn-admin" style="background:#333;" onclick="adminAction('set_balance')">Set üí†</button>
                    </div>
                </div>

                <div class="admin-panel-card">
                    <h3 style="margin-bottom:10px; font-size:14px;">User Control</h3>
                    <div style="max-height:150px; overflow-y:auto; border:1px solid #333; border-radius:6px; margin-bottom:10px;">
                        <div class="user-row">
                            <span style="color:var(--primary);">@current_user</span>
                            <span style="color:var(--accent);">[ONLINE]</span>
                        </div>
                        <div class="user-row">
                            <span>@neo_runner</span>
                            <button style="border:none; background:none; color:red;">[BAN]</button>
                        </div>
                        <div class="user-row">
                            <span>@cyber_punk</span>
                            <button style="border:none; background:none; color:red;">[BAN]</button>
                        </div>
                    </div>
                    <button class="btn-admin" style="background:var(--secondary);" onclick="tg.showAlert('Broadcast sent to 12,405 users')">üì¢ Send Broadcast</button>
                </div>
            </div>
        </div>

    </div>

    <nav class="bottom-nav">
        <div class="nav-item" onclick="switchTab('upgrade')"><i class="fa-solid fa-arrow-up-from-bracket"></i></div>
        <div class="nav-item" onclick="switchTab('crafts')"><i class="fa-solid fa-screwdriver-wrench"></i></div>
        <div class="nav-item center-btn" onclick="switchTab('cases')">
            <div class="icon-wrap"><i class="fa-solid fa-cube"></i></div>
        </div>
        <div class="nav-item" onclick="switchTab('profile')"><i class="fa-regular fa-user"></i></div>
        
        <div id="nav-admin" class="nav-item" onclick="switchTab('admin')">
            <i class="fa-solid fa-user-secret"></i>
        </div>
    </nav>
</div>

<script>
    // --- CONFIGURATION ---
    const ADMIN_ID = 1017573139; // ID –ê–¥–º–∏–Ω–∞
    const tg = window.Telegram.WebApp;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web App
    tg.ready();
    tg.expand();
    tg.setHeaderColor('#13131f');
    tg.setBackgroundColor('#050508');

    // --- STATE MANAGEMENT (Local Storage) ---
    let appState = {
        balance: 0,
        inventory: []
    };

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    function loadState() {
        const saved = localStorage.getItem('cyberRelicsData');
        if (saved) {
            appState = JSON.parse(saved);
        } else {
            appState.balance = 100; // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å
            saveState();
        }
        updateUI();
    }

    function saveState() {
        localStorage.setItem('cyberRelicsData', JSON.stringify(appState));
        updateUI();
    }

    function updateUI() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤ –±–∞–ª–∞–Ω—Å–∞
        document.getElementById('header-balance-val').innerText = appState.balance;
        document.getElementById('profile-balance').innerText = appState.balance;
    }

    // --- USER LOGIC ---
    let currentUser = null;

    function initUser() {
        // –ë–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º
        const user = tg.initDataUnsafe.user;
        
        const avatarEl = document.getElementById('user-avatar');
        const avatarXl = document.getElementById('profile-avatar-xl');
        const nameEl = document.getElementById('profile-name');
        const idEl = document.getElementById('profile-id');

        if (user) {
            currentUser = user;
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            if(user.photo_url) {
                avatarEl.src = user.photo_url;
                avatarXl.src = user.photo_url;
            } else {
                avatarEl.src = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
                avatarXl.src = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
            }
            nameEl.innerText = user.first_name;
            idEl.innerText = "ID: " + user.id;

            // --- –ü–†–û–í–ï–†–ö–ê –ù–ê –ê–î–ú–ò–ù–ê ---
            if (user.id === ADMIN_ID) {
                enableAdminMode();
            }

        } else {
            // –î–µ–º–æ —Ä–µ–∂–∏–º (–≤–Ω–µ —Ç–µ–ª–µ–≥—Ä–∞–º–∞) - –î–ª—è —Ç–µ—Å—Ç–∞ –≤–∫–ª—é—á–∏–º –∞–¥–º–∏–Ω–∫—É
            // –ß—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–µ —Ç–µ–ª–µ–≥—Ä–∞–º–∞, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ:
            // enableAdminMode(); 
            
            nameEl.innerText = "Guest Runner";
            idEl.innerText = "ID: Unknown";
            avatarEl.src = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
            avatarXl.src = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
        }
    }

    function enableAdminMode() {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é
        const adminBtn = document.getElementById('nav-admin');
        adminBtn.classList.add('visible');
        console.log("Admin privileges granted.");
    }

    // --- ADMIN ACTIONS ---
    function adminAction(action) {
        const input = document.getElementById('admin-amount');
        const amount = parseInt(input.value);

        if (isNaN(amount) && action !== 'ban') {
            tg.showAlert("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!");
            return;
        }

        if (action === 'add_balance') {
            appState.balance += amount;
            tg.showPopup({
                title: 'System Override',
                message: `–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} NC –Ω–∞ —Å—á–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.`,
                buttons: [{type: 'ok'}]
            });
        } else if (action === 'set_balance') {
            appState.balance = amount;
            tg.showPopup({
                title: 'System Override',
                message: `–ë–∞–ª–∞–Ω—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${amount} NC.`,
                buttons: [{type: 'ok'}]
            });
        }

        saveState();
        input.value = '';
    }

    // --- GAMEPLAY LOGIC ---
    function tryBuyCase(price) {
        if (appState.balance >= price) {
            tg.showPopup({
                title: 'Confirm Purchase',
                message: `Decrypt archive for ${price} NC?`,
                buttons: [
                    {id: 'buy', type: 'default', text: 'Yes, Hack it'},
                    {type: 'cancel'}
                ]
            }, (btnId) => {
                if (btnId === 'buy') {
                    appState.balance -= price;
                    saveState();
                    // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è
                    tg.showPopup({title: 'Success', message: 'You found: Rare Component!'});
                    if(tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
                }
            });
        } else {
            tg.showAlert("Insufficient Neural Chips. Visit Profile or Admin.");
            if(tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('error');
        }
    }

    // --- NAVIGATION LOGIC ---
    function switchTab(tabName) {
        document.querySelectorAll('.content-view').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));

        const target = document.getElementById('view-' + tabName);
        if(target) target.classList.add('active');

        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏–∫–æ–Ω–æ–∫
        const navs = document.querySelectorAll('.nav-item');
        // –ò–Ω–¥–µ–∫—Å—ã: 0-Upgrade, 1-Craft, 2-Cases, 3-Profile, 4-Admin
        if (tabName === 'upgrade') navs[0].classList.add('active');
        if (tabName === 'crafts') navs[1].classList.add('active');
        if (tabName === 'cases') navs[2].classList.add('active');
        if (tabName === 'profile') navs[3].classList.add('active');
        if (tabName === 'admin') navs[4].classList.add('active');

        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
    }

    // --- BOOTSTRAP ---
    loadState();
    initUser();

</script>
</body>
</html>
